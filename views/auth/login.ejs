<div class="auth-container">
  <div class="card card-450">
    <h1>ÄÄƒng nháº­p</h1>
    
    <% if (typeof flash !== 'undefined' && flash.error && flash.error.length) { %>
      <div class="login-error-message">
        <% flash.error.forEach(msg => { %>
          <div class="error-text"><%= msg.replace(/\n/g, '<br/>') %></div>
        <% }) %>
      </div>
    <% } %>
    
    <% if (typeof flash !== 'undefined' && flash.success && flash.success.length) { %>
      <div class="login-success-message">
        <% flash.success.forEach(msg => { %> 
          <div class="success-text"><%= msg %></div>
        <% }) %>
      </div>
    <% } %>

    <!-- Admin Backup Password Form (only shown when admin is locked) -->
    <% if (typeof showBackupForm !== 'undefined' && showBackupForm && adminLockedEmail) { %>
      <div class="backup-password-section">
        <div class="backup-header">
          <div class="lock-icon">ğŸ”’</div>
          <h2>TÃ i khoáº£n admin Ä‘Ã£ bá»‹ khÃ³a</h2>
          <p class="backup-subtitle">Nháº­p mÃ£ dá»± phÃ²ng Ä‘á»ƒ Ä‘Äƒng nháº­p</p>
        </div>
        
        <form action="/login/backup-password?_csrf=<%= csrfToken %>" method="post" class="backup-form">
          <input type="hidden" name="redirect" value="<%= typeof redirect !== 'undefined' ? redirect : '/' %>" />
          <input type="hidden" name="email" value="<%= adminLockedEmail %>" />
          
          <div class="form-group">
            <label for="backup_password">MÃ£ dá»± phÃ²ng</label>
            <input 
              type="password" 
              id="backup_password" 
              name="backup_password" 
              required 
              placeholder="Nháº­p mÃ£ dá»± phÃ²ng"
              autocomplete="off"
              autofocus
              class="backup-input"
              aria-label="MÃ£ dá»± phÃ²ng"
            />
            <small class="form-hint">MÃ£ dá»± phÃ²ng chá»‰ dÃ nh cho tÃ i khoáº£n admin</small>
          </div>
          
          <button class="btn primary full" type="submit">ÄÄƒng nháº­p báº±ng mÃ£ dá»± phÃ²ng</button>
          
          <div class="backup-footer">
            <button type="button" class="btn-link" onclick="showNormalLogin()">Quay láº¡i Ä‘Äƒng nháº­p bÃ¬nh thÆ°á»ng</button>
          </div>
        </form>
      </div>
    <% } %>

    <!-- Normal Login Form (hidden when backup form is shown) -->
    <% const hideNormalLogin = (typeof showBackupForm !== 'undefined' && showBackupForm); %>
    <div class="normal-login-section" id="normalLoginSection"<% if (hideNormalLogin) { %> style="display: none;"<% } %>>
      <% if (typeof hasGoogleAuth !== 'undefined' && hasGoogleAuth) { %>
        <a href="/auth/google" class="btn google-btn">
          <span class="google-icon">ğŸ”µ</span>
          <span>ÄÄƒng nháº­p báº±ng Google</span>
        </a>
        <div class="divider">
          <span>hoáº·c</span>
        </div>
      <% } %>
      
      <form action="/login?_csrf=<%= csrfToken %>" method="post" class="login-form">
        <input type="hidden" name="redirect" value="<%= typeof redirect !== 'undefined' ? redirect : '/' %>" />
        <div class="form-group">
          <label for="email">Email</label>
          <input 
            id="email" 
            name="email" 
            type="email" 
            required 
            placeholder="your@email.com"
            autocomplete="email"
            aria-label="Email Ä‘Äƒng nháº­p"
            value="<%= typeof adminLockedEmail !== 'undefined' && adminLockedEmail ? adminLockedEmail : '' %>"
          />
        </div>
        <div class="form-group">
          <label for="password">Máº­t kháº©u</label>
          <input 
            id="password" 
            name="password" 
            type="password" 
            required 
            placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
            autocomplete="current-password"
            aria-label="Máº­t kháº©u"
          />
        </div>
        <button class="btn primary full" type="submit">ÄÄƒng nháº­p</button>
      </form>
      
      <div class="login-footer">
        <p class="muted">ChÆ°a cÃ³ tÃ i khoáº£n? <a href="/register">ÄÄƒng kÃ½ ngay</a></p>
        <p class="muted"><a href="/forgot-password">QuÃªn máº­t kháº©u?</a></p>
      </div>
    </div>
  </div>
</div>

<script>
function showNormalLogin() {
  document.getElementById('normalLoginSection').style.display = 'block';
  document.querySelector('.backup-password-section').style.display = 'none';
  document.getElementById('email')?.focus();
}
</script>

<!-- Login-specific styles moved to public/css/style.css -->
