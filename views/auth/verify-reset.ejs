<div class="auth-container">
  <div class="card card-450">
    <h1>Xác thực mã OTP</h1>

    <% if (typeof flash !== 'undefined' && flash.error && flash.error.length) { %>
      <div class="login-error-message">
        <% flash.error.forEach(msg => { %>
          <div class="error-text"><%= msg.replace(/\n/g, '<br/>') %></div>
        <% }) %>
      </div>
    <% } %>

    <% if (typeof flash !== 'undefined' && flash.success && flash.success.length) { %>
      <div class="login-success-message">
        <% flash.success.forEach(msg => { %>
          <div class="success-text"><%= msg %></div>
        <% }) %>
      </div>
    <% } %>

    <form action="/verify-reset?_csrf=<%= csrfToken %>" method="post" class="login-form">
      <input type="hidden" name="email" value="<%= typeof email !== 'undefined' ? email : '' %>" />
      <div class="form-group">
        <label for="otp">Mã OTP</label>
        <input id="otp" name="otp" type="text" required placeholder="Nhập mã OTP" autofocus />
        <small class="form-hint">Mã sẽ được gửi tới email của bạn</small>
      </div>
      <button class="btn primary full" type="submit">Xác thực OTP</button>
    </form>

    <div class="login-footer">
      <p class="muted"><a href="/forgot-password">Gửi lại mã / Thay đổi email</a></p>
    </div>
  </div>
</div>
